"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5477],{5477:(T,c,s)=>{s.r(c),s.d(c,{RoomPageModule:()=>M});var p=s(177),v=s(9417),r=s(4742),u=s(2175),d=s(467);const g=(0,s(5083).F3)("Jitsi",{web:()=>s.e(7185).then(s.bind(s,7185)).then(n=>new n.JitsiWeb)});var f=s(5826),C=s(6539),R=s(2177),P=s(8833),e=s(4438);const E=["inputRoomPwd"];function j(n,l){1&n&&e.nrm(0,"div")}function D(n,l){if(1&n){const a=e.RV6();e.j41(0,"div")(1,"div",8),e.EFF(2,"M\u1eadt kh\u1ea9u "),e.j41(3,"ion-text",9),e.EFF(4,"*"),e.k0s()(),e.j41(5,"ion-input",10,0),e.bIt("ionChange",function(t){e.eBV(a);const i=e.XpG(2);return e.Njj(i.changeRoomPwd(t))})("keyup.enter",function(){e.eBV(a);const t=e.XpG(2);return e.Njj(t.checkAccepted())}),e.k0s()()}}function F(n,l){if(1&n){const a=e.RV6();e.j41(0,"div",11)(1,"div",8),e.EFF(2,"T\xean hi\u1ec3n th\u1ecb "),e.j41(3,"ion-text",9),e.EFF(4,"*"),e.k0s()(),e.j41(5,"ion-input",12),e.bIt("ionChange",function(t){e.eBV(a);const i=e.XpG(2);return e.Njj(i.changeUserName(t))}),e.k0s()(),e.j41(6,"div",11)(7,"div",8),e.EFF(8,"Email "),e.j41(9,"ion-text",9),e.EFF(10,"*"),e.k0s()(),e.j41(11,"ion-input",13),e.bIt("ionChange",function(t){e.eBV(a);const i=e.XpG(2);return e.Njj(i.changeUserEmail(t))}),e.k0s()()}if(2&n){const a=e.XpG(2);e.R7$(5),e.Y8G("value",a.userData.name),e.R7$(6),e.Y8G("value",a.userData.email)}}function A(n,l){if(1&n){const a=e.RV6();e.j41(0,"div")(1,"div",8),e.EFF(2,"M\u1eadt kh\u1ea9u "),e.j41(3,"ion-text",9),e.EFF(4,"*"),e.k0s()(),e.j41(5,"ion-input",10,0),e.bIt("ionChange",function(t){e.eBV(a);const i=e.XpG(2);return e.Njj(i.changeRoomPwd(t))})("keyup.enter",function(){e.eBV(a);const t=e.XpG(2);return e.Njj(t.checkAccepted())}),e.k0s()()}}function x(n,l){if(1&n){const a=e.RV6();e.j41(0,"div",11)(1,"div",8),e.EFF(2,"T\xean hi\u1ec3n th\u1ecb "),e.j41(3,"ion-text",9),e.EFF(4,"*"),e.k0s()(),e.j41(5,"ion-input",12),e.bIt("ionChange",function(t){e.eBV(a);const i=e.XpG(2);return e.Njj(i.changeUserName(t))}),e.k0s()(),e.j41(6,"div",11)(7,"div",8),e.EFF(8,"Email "),e.j41(9,"ion-text",9),e.EFF(10,"*"),e.k0s()(),e.j41(11,"ion-input",13),e.bIt("ionChange",function(t){e.eBV(a);const i=e.XpG(2);return e.Njj(i.changeUserEmail(t))}),e.k0s()()}if(2&n){const a=e.XpG(2);e.R7$(5),e.Y8G("value",a.userData.name),e.R7$(6),e.Y8G("value",a.userData.email)}}function k(n,l){if(1&n){const a=e.RV6();e.j41(0,"div",5),e.DNE(1,D,7,0,"div")(2,F,12,2)(3,A,7,0,"div")(4,x,12,2),e.j41(5,"div",6)(6,"ion-button",7),e.bIt("click",function(){e.eBV(a);const t=e.XpG();return e.Njj(t.checkAccepted())}),e.j41(7,"ion-label"),e.EFF(8,"Tham gia"),e.k0s()()()()}if(2&n){const a=e.XpG();e.R7$(),e.vxM(1,a.isPassedPwd?-1:1),e.R7$(),e.vxM(2,a.isPassedAuth?-1:2),e.R7$(),e.vxM(3,a.isPassedPwd?-1:3),e.R7$(),e.vxM(4,a.isPassedAuth?-1:4)}}const w=[{path:"",component:(()=>{var n;class l{constructor(o,t,i,m){this.router=t,this.modalController=i,this.toastController=m;let h=o.snapshot.params.id;h&&(this.roomId=h)}ngOnInit(){var o=this;(0,d.A)(function*(){var t,i;o.user=(yield(0,C.xk)()).data,o.userData={name:null===(t=o.user)||void 0===t?void 0:t.name,email:null===(i=o.user)||void 0===i?void 0:i.email},(0,R.r)(),o.refreshData()})()}ngAfterViewInit(){setTimeout(()=>{var o;null===(o=this.inputRoomPwd)||void 0===o||o.setFocus()},300)}refreshData(){var o=this;return(0,d.A)(function*(){(0,f.vx)({params:{id:o.roomId},callback:t=>{o.roomData=null==t?void 0:t.data,o.checkAccepted()}})})()}checkAccepted(){var o,t,i;this.isPassedAuth=!(!this.userData.name||!this.userData.email),this.isPassedPwd=null===(o=this.roomData)||void 0===o||!o.password||(null===(t=this.roomData)||void 0===t?void 0:t.password)==(null===(i=this.roomData)||void 0===i?void 0:i.confirm_password),this.isAccepted=this.isPassedAuth&&this.isPassedPwd}changeRoomPwd(o){var t=this;return(0,d.A)(function*(){t.roomData&&(t.roomData.confirm_password=o.detail.value)})()}changeUserName(o){var t=this;return(0,d.A)(function*(){var i;t.userData.name=null===(i=o.detail.value)||void 0===i?void 0:i.trim()})()}changeUserEmail(o){var t=this;return(0,d.A)(function*(){var i;t.userData.email=null===(i=o.detail.value)||void 0===i?void 0:i.trim()})()}initJitsi(){var o=this;return(0,d.A)(function*(){var t;if(o.roomData&&o.roomData.roomName&&null!==(t=o.roomData.server)&&void 0!==t&&t.ip&&o.roomData.token){const i=yield g.joinConference({roomName:o.roomData.roomName,url:o.roomData.server.ip,featureFlags:{"prejoinpage.enabled":!1,"recording.enabled":!1,"live-streaming.enabled":!1,"android.screensharing.enabled":!1},subject:o.userData.name,displayName:o.userData.name,email:o.userData.email,avatarURL:"",startWithAudioMuted:!0,startWithVideoMuted:!1,chatEnabled:!1,inviteEnabled:!1,token:o.roomData.token});console.log(i),window.addEventListener("onConferenceJoined",()=>{}),window.addEventListener("onConferenceTerminated",()=>{}),window.addEventListener("onConferenceLeft",()=>{}),window.addEventListener("onChatMessageReceived",m=>{}),window.addEventListener("onParticipantsInfoRetrieved",m=>{}),window.addEventListener("readyToClose",()=>{console.log("User has left the conference"),window.location.replace(P._.HOME)})}})()}}return(n=l).\u0275fac=function(o){return new(o||n)(e.rXU(u.nX),e.rXU(u.Ix),e.rXU(r.W3),e.rXU(r.K_))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-room"]],viewQuery:function(o,t){if(1&o&&e.GBs(E,5),2&o){let i;e.mGM(i=e.lsd())&&(t.inputRoomPwd=i.first)}},decls:9,vars:2,consts:[["inputRoomPwd",""],[1,"ion-no-border","ion-header-custom"],["color","primary"],["slot","start"],["defaultHref","/","text",""],[1,"ion-padding"],[1,"mt-3"],["color","primary","expand","block",1,"ion-no-margin",3,"click"],[1,"fw-600","fs-16","mb-1"],["color","danger"],["mode","md","fill","outline","clear-input","true","placeholder","Nh\u1eadp m\u1eadt kh\u1ea9u ph\xf2ng h\u1ecdp",3,"ionChange","keyup.enter"],[1,"mt-4"],["mode","md","fill","outline","clear-input","true","placeholder","Nh\u1eadp t\xean hi\u1ec3n th\u1ecb","minlength","6","maxlength","100",3,"ionChange","value"],["mode","md","fill","outline","clear-input","true","placeholder","Nh\u1eadp email","minlength","6","maxlength","100",3,"ionChange","value"]],template:function(o,t){1&o&&(e.j41(0,"ion-header",1)(1,"ion-toolbar",2)(2,"ion-buttons",3),e.nrm(3,"ion-back-button",4),e.k0s(),e.j41(4,"ion-title"),e.EFF(5),e.k0s()()(),e.j41(6,"ion-content"),e.DNE(7,j,1,0,"div")(8,k,9,4),e.k0s()),2&o&&(e.R7$(5),e.JRh(null==t.roomData?null:t.roomData.title),e.R7$(2),e.vxM(7,t.isAccepted&&t.roomData&&t.userData?7:8))},dependencies:[r.Jm,r.QW,r.W9,r.eU,r.$w,r.he,r.IO,r.BC,r.ai,r.Gw,r.el],styles:["ion-input[fill=outline][_ngcontent-%COMP%]{--border-radius: 0}"]}),l})()}];let $=(()=>{var n;class l{}return(n=l).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[u.iI.forChild(w),u.iI]}),l})(),M=(()=>{var n;class l{}return(n=l).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[p.MD,v.YN,r.bv,$]}),l})()}}]);